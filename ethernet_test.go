package protodecode

import (
	"testing"
)

func TestEthernet(t *testing.T) {
	b := []byte{
		156, 78, 54, 89, 178, 84,
		232, 222, 39, 187, 107, 170,
		8, 0,
		69, 32, 0, 71, 159, 133, 0, 0, 41, 17, 112, 72,
		192, 168, 0, 1,
		192, 168, 0, 103,
		0, 53, 111, 47, 0, 51, 144, 128, 126, 47, 129, 128,
		0, 1, 0, 1, 0, 0, 0, 0, 6, 109, 105, 115, 102, 114,
		97, 2, 109, 101, 0, 0, 1, 0, 1, 192, 12, 0, 1, 0,
		1, 0, 0, 84, 7, 0, 4, 199, 58, 162, 130,
	}

	frame := DecodeEthernet(b)
	if frame.Source.String() != "9c:4e:36:59:b2:54" {
		t.Error("Got the wrong source MAC:", frame.Source.String())
	}
}

func BenchmarkEthernet(b *testing.B) {
	for i := 0; i < b.N; i++ {
		b := []byte{
			69, 0, 0, 126, 186, 180, 64, 0, 64, 6, 151, 204,
			192, 168, 0, 103,
			173, 194, 121, 39,
			187, 33, 0, 80, 130, 127, 178, 159, 110, 68, 148, 175, 128, 24, 0,
			229, 76, 61, 0, 0, 1, 1, 8, 10, 0, 63, 8, 48, 14, 52, 9, 77, 71, 69,
			84, 32, 47, 32, 72, 84, 84, 80, 47, 49, 46, 49, 13, 10, 85, 115, 101,
			114, 45, 65, 103, 101, 110, 116, 58, 32, 99, 117, 114, 108, 47, 55,
			46, 51, 53, 46, 48, 13, 10, 72, 111, 115, 116, 58, 32, 103, 111, 111,
			103, 108, 101, 46, 99, 111, 109, 13, 10, 65, 99, 99, 101, 112, 116,
			58, 32, 42, 47, 42, 13, 10, 13, 10,
		}

		DecodeEthernet(b)
	}
}
