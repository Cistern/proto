package protodecode

import (
	"testing"
)

func TestEthernet(t *testing.T) {
	b := []byte{
		156, 78, 54, 89, 178, 84,
		232, 222, 39, 187, 107, 170,
		8, 0,
		69, 32, 0, 71, 159, 133, 0, 0, 41, 17, 112, 72,
		192, 168, 0, 1,
		192, 168, 0, 103,
		0, 53, 111, 47, 0, 51, 144, 128, 126, 47, 129, 128,
		0, 1, 0, 1, 0, 0, 0, 0, 6, 109, 105, 115, 102, 114,
		97, 2, 109, 101, 0, 0, 1, 0, 1, 192, 12, 0, 1, 0,
		1, 0, 0, 84, 7, 0, 4, 199, 58, 162, 130,
	}

	frame := DecodeEthernet(b)
	if frame.Source.String() != "9c:4e:36:59:b2:54" {
		t.Error("Got the wrong source MAC:", frame.Source.String())
	}
}

func BenchmarkEthernet(b *testing.B) {
	for i := 0; i < b.N; i++ {
		b := []byte{
			156, 78, 54, 89, 178, 84,
			232, 222, 39, 187, 107, 170,
			8, 0,
			69, 32, 0, 71, 159, 133, 0, 0, 41, 17, 112, 72,
			192, 168, 0, 1,
			192, 168, 0, 103,
			0, 53, 111, 47, 0, 51, 144, 128, 126, 47, 129, 128,
			0, 1, 0, 1, 0, 0, 0, 0, 6, 109, 105, 115, 102, 114,
			97, 2, 109, 101, 0, 0, 1, 0, 1, 192, 12, 0, 1, 0,
			1, 0, 0, 84, 7, 0, 4, 199, 58, 162, 130,
		}

		DecodeEthernet(b)
	}
}
